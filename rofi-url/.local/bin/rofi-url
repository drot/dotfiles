#!/usr/bin/env bash

link_handler() {
    local regex='(((http|https|ftp|gopher)|mailto)[.:][^ >"\t]*|www\.[-a-z0-9.]+)[^ .,;\t>">\):]'
    grep -Po "$regex" | tac | rofi -dmenu -i -l 10 -w "$WINDOWID" -p "$1" | "${@:2}"
}

case $1 in
    open)
        link_handler "Open URL:" xargs -r xdg-open
        ;;
    copy)
        link_handler "Copy URL:" xclip -selection clipboard
        ;;
    *)
        printf >&2 'Bad option "%s"\n' "$1"
        exit 1
        ;;
esac
